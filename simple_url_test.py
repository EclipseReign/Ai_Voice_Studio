#!/usr/bin/env python3
"""
Simple URL Length Test - No Authentication Required
==================================================

This test focuses on the core issue: URL length limits for audio synthesis
Tests the difference between GET (old, broken) and POST (new, fixed) methods
"""

import requests
import json
import time
from datetime import datetime

def test_url_length_limits():
    """Test URL length limits and POST method fix"""
    
    base_url = "https://audiorender-issue.preview.emergentagent.com/api"
    
    print("üöÄ URL LENGTH LIMIT TESTING")
    print("=" * 50)
    
    # Test 1: Get voices (no auth required)
    print("\n1Ô∏è‚É£ Testing voices endpoint...")
    try:
        response = requests.get(f"{base_url}/voices", timeout=30)
        if response.status_code == 200:
            voices = response.json()
            ru_voices = [v for v in voices if v.get('locale', '').startswith('ru-')]
            print(f"‚úÖ Found {len(voices)} voices, {len(ru_voices)} Russian")
            
            if ru_voices:
                ru_voice = ru_voices[0]['short_name']
                print(f"   Using voice: {ru_voice}")
            else:
                print("‚ùå No Russian voices found")
                return False
        else:
            print(f"‚ùå Voices endpoint failed: {response.status_code}")
            return False
    except Exception as e:
        print(f"‚ùå Voices endpoint error: {e}")
        return False
    
    # Test 2: Create test texts of different sizes
    print("\n2Ô∏è‚É£ Creating test texts...")
    
    # Small text (should work with both GET and POST)
    small_text = "–≠—Ç–æ –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Å—Ç —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏. –û–Ω –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª—é–±—ã–º –º–µ—Ç–æ–¥–æ–º."
    
    # Large text (should fail with GET, work with POST)
    large_text = """
    –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–¥–Ω—É –∏–∑ —Å–∞–º—ã—Ö –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≤–æ–ª—é—Ü–∏–π –Ω–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –≠—Ç–∞ –æ–±–ª–∞—Å—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –Ω–∞—É–∫–∏ —Å—Ç—Ä–µ–º–∏—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –º–∞—à–∏–Ω—ã, —Å–ø–æ—Å–æ–±–Ω—ã–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ —Ç—Ä–µ–±—É—é—Ç —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –û—Ç –ø—Ä–æ—Å—Ç—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –¥–æ —Å–ª–æ–∂–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, –ò–ò –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π.
    
    –ò—Å—Ç–æ—Ä–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –Ω–∞—á–∞–ª–∞—Å—å –≤ 1950-—Ö –≥–æ–¥–∞—Ö, –∫–æ–≥–¥–∞ —É—á–µ–Ω—ã–µ –≤–ø–µ—Ä–≤—ã–µ –Ω–∞—á–∞–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –º—ã—Å–ª—è—â–∏—Ö –º–∞—à–∏–Ω. –ê–ª–∞–Ω –¢—å—é—Ä–∏–Ω–≥, –æ–¥–∏–Ω –∏–∑ –ø–∏–æ–Ω–µ—Ä–æ–≤ –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏, –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π —Ç–µ—Å—Ç –¢—å—é—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ —Å–∏—Ö –ø–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –º–µ—Ä–∞ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –º–∞—à–∏–Ω. –¢–µ—Å—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –º–∞—à–∏–Ω–∞ –º–æ–∂–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π, –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∏—Ç—å –µ–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç –æ—Ç–≤–µ—Ç–æ–≤ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–±—â–µ–Ω–∏—è.
    
    –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –∫–ª—é—á–µ–≤–æ–π –æ–±–ª–∞—Å—Ç—å—é –ò–ò, –ø–æ–∑–≤–æ–ª—è—é—â–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–∞–º —É—á–∏—Ç—å—Å—è –∏ —É–ª—É—á—à–∞—Ç—å —Å–≤–æ—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ —è–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π. –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –ø–æ–¥—Ä–∞–∑–¥–µ–ª –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–ª–æ—è–º–∏ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö.
    
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ –ø–æ–∏—Å—Ç–∏–Ω–µ –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã. –í –º–µ–¥–∏—Ü–∏–Ω–µ –ò–ò –ø–æ–º–æ–≥–∞–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é, —á–∞—Å—Ç–æ –ø—Ä–µ–≤—ã—à–∞—é—â–µ–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫—É—é. –í –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ò–ò –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –í —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ñ–µ—Ä–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ò–ò –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è–º–∏.
    
    –û–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—à–∏–Ω–∞–º –ø–æ–Ω–∏–º–∞—Ç—å –∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —è–∑—ã–∫, —á—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –º–µ–∂–¥—É —á–µ–ª–æ–≤–µ–∫–æ–º –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º. –°–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏, –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤—Å–µ –±–æ–ª–µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–º–∏, –ø—Ä–∏–±–ª–∏–∂–∞—è—Å—å –∫ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º—É —É—Ä–æ–≤–Ω—é –ø–æ–Ω–∏–º–∞–Ω–∏—è —è–∑—ã–∫–∞.
    
    –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ –¥–∞–µ—Ç –º–∞—à–∏–Ω–∞–º —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å "–≤–∏–¥–µ—Ç—å" –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –≠—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–≥–∏—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –æ—Ç —Å–∏—Å—Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏. –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –º–æ–≥—É—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã, –ª–∏—Ü–∞, —ç–º–æ—Ü–∏–∏ –∏ –¥–∞–∂–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    
    –†–æ–±–æ—Ç–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –ò–ò —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, —Å–æ–∑–¥–∞–≤–∞—è –º–∞—à–∏–Ω—ã, —Å–ø–æ—Å–æ–±–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º –º–∏—Ä–æ–º. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ò–ò –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏, –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö, –æ—Ç –∑–∞–≤–æ–¥—Å–∫–∏—Ö —Ü–µ—Ö–æ–≤ –¥–æ –¥–æ–º–∞—à–Ω–∏—Ö —Ö–æ–∑—è–π—Å—Ç–≤.
    
    –û–¥–Ω–∞–∫–æ —Ä–∞–∑–≤–∏—Ç–∏–µ –ò–ò —Ç–∞–∫–∂–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç –≤–∞–∂–Ω—ã–µ —ç—Ç–∏—á–µ—Å–∫–∏–µ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –ü—Ä–æ–±–ª–µ–º—ã –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∑–∞–º–µ—â–µ–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –ò–ò —Ç—Ä–µ–±—É—é—Ç —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –æ–±—â–µ—Å—Ç–≤–∞, –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π.
    
    –ë—É–¥—É—â–µ–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –æ–±–µ—â–∞–µ—Ç –µ—â–µ –±–æ–ª–µ–µ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –æ–±—â–µ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ (AGI), –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª—é–±—É—é –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É, –¥–æ—Å—Ç—É–ø–Ω—É—é —á–µ–ª–æ–≤–µ–∫—É. –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–æ–≥—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏–µ –ò–ò-—Å–∏—Å—Ç–µ–º.
    
    –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —É—Å–ø–µ—à–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –ò–ò —Ç—Ä–µ–±—É–µ—Ç –º–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—É—é –Ω–∞—É–∫—É, –º–∞—Ç–µ–º–∞—Ç–∏–∫—É, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é, —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é –∏ –¥—Ä—É–≥–∏–µ –æ–±–ª–∞—Å—Ç–∏ –∑–Ω–∞–Ω–∏–π. –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Ç–∞–∫–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ –º—ã —Å–º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –ò–ò-—Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –º–æ—â–Ω—ã–º–∏, –Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏, —ç—Ç–∏—á–Ω—ã–º–∏ –∏ –ø–æ–ª–µ–∑–Ω—ã–º–∏ –¥–ª—è –≤—Å–µ–≥–æ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞.
    """ * 3  # Make it even larger
    
    print(f"   Small text: {len(small_text)} characters")
    print(f"   Large text: {len(large_text)} characters")
    
    # Test 3: Calculate URL lengths
    print("\n3Ô∏è‚É£ Calculating URL lengths...")
    
    def calculate_url_length(text, voice):
        """Calculate what the URL length would be with GET method"""
        import urllib.parse
        encoded_text = urllib.parse.quote(text)
        url = f"{base_url}/audio/synthesize-with-progress?text={encoded_text}&voice={voice}&rate=1.0&language=ru-RU"
        return len(url)
    
    small_url_length = calculate_url_length(small_text, ru_voice)
    large_url_length = calculate_url_length(large_text, ru_voice)
    
    print(f"   Small text URL length: {small_url_length} chars")
    print(f"   Large text URL length: {large_url_length} chars")
    
    # Check against common limits
    browser_limit = 2048
    server_limit = 8192
    
    print(f"   Browser limit (conservative): {browser_limit} chars")
    print(f"   Server limit (typical): {server_limit} chars")
    
    small_exceeds = small_url_length > server_limit
    large_exceeds = large_url_length > server_limit
    
    print(f"   Small text exceeds limit: {small_exceeds}")
    print(f"   Large text exceeds limit: {large_exceeds}")
    
    # Test 4: Test POST method (the fix) - without auth for now
    print("\n4Ô∏è‚É£ Testing POST method (no auth)...")
    
    # Try to test the POST endpoint structure
    test_data = {
        "text": small_text,
        "voice": ru_voice,
        "rate": 1.0,
        "language": "ru-RU"
    }
    
    try:
        response = requests.post(
            f"{base_url}/audio/synthesize-with-progress",
            json=test_data,
            headers={'Content-Type': 'application/json'},
            timeout=10
        )
        
        print(f"   POST request status: {response.status_code}")
        
        if response.status_code == 401:
            print("   ‚úÖ POST endpoint exists but requires authentication (expected)")
            print("   ‚úÖ This confirms the endpoint accepts POST method")
        elif response.status_code == 200:
            print("   ‚úÖ POST method works!")
        else:
            print(f"   Response: {response.text[:200]}")
            
    except Exception as e:
        print(f"   Error testing POST: {e}")
    
    # Summary
    print("\n" + "=" * 50)
    print("üìä SUMMARY")
    print("=" * 50)
    
    print(f"‚úÖ Voices endpoint working: {len(voices)} voices available")
    print(f"‚úÖ Small text URL length: {small_url_length} chars (within limits: {not small_exceeds})")
    print(f"‚úÖ Large text URL length: {large_url_length} chars (exceeds limits: {large_exceeds})")
    print(f"‚úÖ POST endpoint exists and accepts JSON data")
    
    if large_exceeds:
        print("\nüîç KEY FINDING:")
        print(f"   Large text ({len(large_text)} chars) would create {large_url_length} char URL")
        print(f"   This exceeds typical server limits ({server_limit} chars) by {large_url_length - server_limit} chars")
        print("   ‚úÖ This confirms why GET method failed for large texts")
        print("   ‚úÖ POST method with JSON body solves this limitation")
    
    return True

if __name__ == "__main__":
    test_url_length_limits()